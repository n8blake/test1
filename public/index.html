<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Firebase Hosting</title>
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/css/styles.css">
    <!-- update the version number as needed -->
    <script defer src="/__/firebase/4.2.0/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/4.2.0/firebase-auth.js"></script>
    <script defer src="/__/firebase/4.2.0/firebase-database.js"></script>
    <script defer src="/__/firebase/4.2.0/firebase-messaging.js"></script>
    <script defer src="/__/firebase/4.2.0/firebase-storage.js"></script>
    <script defer src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.5/angular.min.js"></script>
    <script defer src="/js/jquery-1.11.3.min.js"></script>
    <!--<script defer src="fb_test.js"></script>-->

    <!-- initialize the SDK after all desired features are loaded -->
    <!--<script defer src="/__/firebase/init.js"></script>-->

    <style media="screen">
    </style>
  </head>
  <body ng-app="myApp">
    <div ng-controller="myController">

    <div class="message">
      <h2 id="myWelcome"></h2>
      <h3 id="userInfo"></h3>
    </div>
    <div class="message" ng-if="isLoaded">
      <br>
      <h3>Woot! I'm here bitches!</h3>
    </div>

  </div>
      <!--<h2>Welcome</h2>
      <h1>Firebase Hosting Setup Complete</h1>
      <p>You're seeing this because you've successfully setup Firebase Hosting. Now it's time to go build something extraordinary!</p>
      <a target="_blank" href="https://firebase.google.com/docs/hosting/">Open Hosting Documentation</a>
    </div>
    <p id="load">Firebase SDK Loading&hellip;</p>-->

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
        // // The Firebase SDK is initialized and available here!
        //
        // firebase.auth().onAuthStateChanged(user => { });
        // firebase.database().ref('/path/to/ref').on('value', snapshot => { });
        // firebase.messaging().requestPermission().then(() => { });
        // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
        //
        // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥

        try {
         

          document.getElementById('myWelcome').innerHTML = 'Hello world! Hello Firebase!';

            // Initialize Firebase
            var config = {
              apiKey: "AIzaSyD9YHlN7a25j2JWolmYsB-a8dwHS3u8peg",
              authDomain: "test1-1cbfb.firebaseapp.com",
              databaseURL: "https://test1-1cbfb.firebaseio.com",
              projectId: "test1-1cbfb",
              storageBucket: "test1-1cbfb.appspot.com",
              messagingSenderId: "591043788808"
            };
            firebase.initializeApp(config);

          //let app = firebase.app();

         /* let features = ['auth', 'database', 'messaging', 'storage'].filter(feature => typeof app[feature] === 'function');
          //document.getElementById('load').innerHTML = `Firebase SDK loaded with ${features.join(', ')}`;*/

          console.log("Hello from index.html");

          var provider = new firebase.auth.GoogleAuthProvider();

          firebase.auth().signInWithPopup(provider).then(function(result) {
          // This gives you a Google Access Token. You can use it to access the Google API.
          var token = result.credential.accessToken;
          // The signed-in user info.
          var user = result.user;
          // ...
          //console.log(user);
          if(user){
            window.user = user;
            window.userAuthenticated = true;
            firebase.auth().setPersistence(firebase.auth.Auth.Persistence.SESSION)
                .then(function() {
                  // Existing and future Auth states are now persisted in the current
                  // session only. Closing the window would clear any existing state even
                  // if a user forgets to sign out.
                  // ...
                  // New sign-in will be persisted with session persistence.
                  return firebase.auth().signInWithEmailAndPassword(email, password);
                })
                .catch(function(error) {
                  // Handle Errors here.
                  var errorCode = error.code;
                  var errorMessage = error.message;
                });

            document.getElementById('userInfo').innerHTML = '<i class="fa fa-check-circle" aria-hidden="true"></i>' + user.providerData[0].displayName;

            // Get a reference to the database service
            var database = firebase.database();

            //console.log(database);

            /*// jQuery
              $.getScript('/js/ngApp.js', function()
              {
                  console.log('Loaded Angular app.');
              });*/

          } else {

            document.getElementById('userInfo').innerHTML = '<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> User not authenticated!';

          }
          




        }).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // The email of the user's account used.
          var email = error.email;
          // The firebase.auth.AuthCredential type that was used.
          var credential = error.credential;
          // ...

          document.getElementById('userInfo').innerHTML = '<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> User not authenticated!';

        });


        

        } catch (e) {
          console.error(e);
          document.getElementById('myWelcome').innerHTML = 'Error loading the Firebase SDK, check the console.';
        }
      });
    </script>

  </body>
</html>
